<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="angular," />










<meta name="description" content="angular的指令  在使用angular的时候指令是不可缺少的，angular有自带的指令，但是自带的指令经常不能满足我们的业务需求，这时候就需要我们来封装自定义指令。">
<meta name="keywords" content="angular">
<meta property="og:type" content="article">
<meta property="og:title" content="angular的指令">
<meta property="og:url" content="http://yoursite.com/2018/07/20/angular的指令/index.html">
<meta property="og:site_name" content="AaronWang的个人博客">
<meta property="og:description" content="angular的指令  在使用angular的时候指令是不可缺少的，angular有自带的指令，但是自带的指令经常不能满足我们的业务需求，这时候就需要我们来封装自定义指令。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-08-06T08:52:36.440Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="angular的指令">
<meta name="twitter:description" content="angular的指令  在使用angular的时候指令是不可缺少的，angular有自带的指令，但是自带的指令经常不能满足我们的业务需求，这时候就需要我们来封装自定义指令。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/07/20/angular的指令/"/>





  <title>angular的指令 | AaronWang的个人博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/wangliangioi/wangliangioi.github.io.git"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AaronWang的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/angular的指令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Aaron Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AaronWang的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">angular的指令</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-20T15:17:50+08:00">
                2018-07-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Angular/" itemprop="url" rel="index">
                    <span itemprop="name">Angular</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="angular的指令"><a href="#angular的指令" class="headerlink" title="angular的指令"></a>angular的指令</h2><p>  在使用angular的时候指令是不可缺少的，angular有自带的指令，但是自带的指令经常不能满足我们的业务需求，这时候就需要我们来封装自定义指令。</p>
<a id="more"></a>
<h3 id="angular的内置指令"><a href="#angular的内置指令" class="headerlink" title="angular的内置指令"></a>angular的内置指令</h3><p>在angular中，以ng-开头的html标签属性，称之为指令。下面介绍一些常用的ng指令</p>
<ol>
<li><p>ng-app</p>
<p>ng-app 指令用于告诉 AngularJS 应用当前这个元素是根元素。</p>
<p>所有 AngularJS 应用都必须要要一个根元素。</p>
<p>HTML 文档中只允许有一个 ng-app 指令，如果有多个 ng-app 指令，则只有第一个会被使用。</p>
<pre><code>&lt;div ng-app=&quot;myApp&quot; &gt;&lt;/div&gt;

&lt;script&gt;
    var app = angular.module(&quot;myApp&quot;, []);
&lt;/script&gt;
</code></pre></li>
<li><p>ng-controller</p>
<p>ng-controller 指令用于为你的应用添加控制器。</p>
<p>在控制器中，你可以编写代码，制作函数和变量，并使用 scope 对象来访问。</p>
<pre><code>&lt;div ng-app=&quot;myApp&quot; ng-controller=&quot;myCtrl&quot;&gt;&lt;/div&gt;

&lt;script&gt;
var app =      angular.module(&apos;myApp&apos;, []);
app.controller(&apos;myCtrl&apos;, function($scope) {
});
&lt;/script&gt;
</code></pre></li>
<li><p>ng-init</p>
<p>这个指令用于进行模块的初始化，一个最简单的使用方法是进行数据的初始化：</p>
<pre><code>&lt;div ng-init=&quot;cost=5&quot;&gt;
    &lt;p&gt;单价： {{  cost }}&lt;/p&gt;
&lt;/div&gt;
</code></pre></li>
<li><p>ng-bind</p>
<p>这个指令可以用来数据绑定，和{ { } }的作用差不多，只是我们可以用这个指令来避免FOUC(Flash Of Unrendered Content)，也就是未渲染导致的闪烁。</p>
<pre><code>&lt;p ng-bind=&quot;msg&quot;&gt; &lt;/p&gt;
</code></pre><p>ng-bind-template指令</p>
<p>这个指令跟ng-bind 差不多</p>
<p>ng-bind是指替换元素的textContent为ng-bind的值</p>
<p>ng-bind-template是指替换元素的textContent的值为ng-bind-template经过angular.parse().assign的内容;</p>
</li>
<li><p>ng-repeat</p>
<p>ng-repeat指令用于进行反复输出，一般用于对数组的遍历，</p>
<pre><code>&lt;ul&gt;
     &lt;li ng-repeat=&quot;item in items&quot;&gt; //item对应的是遍历items时的每一条数据，items是我们要遍历的数据(是一个数组)
        {{ item.data }}
     &lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>数据中有完全相等的项时会报错，这时候要用ng-repeat=”item in items track by $index”</p>
</li>
<li><p>ng-class</p>
<p>ng-class是控制元素的class样式，以下是ng-class的几种用法</p>
<p>方法一、</p>
<pre><code>ng-class=&quot;{true : &apos;chose green&apos;,false : &apos;chose&apos; }[choseAll]&quot;
</code></pre><p>“chose green”,”chose”是CSS样式,choseAll是判断条件，值为”true”or”false”</p>
<p>方法二、</p>
<pre><code>ng-class=&quot;{&apos;chose green&apos; : isShow, &apos;chose&apos; : !isShow}&quot;
</code></pre><p>isShow是判断条件，值为“true”or“false”</p>
<p>方法三、</p>
<pre><code>ng-class=&quot;{{style1}}&quot;

$scope.style1 = &quot;{&apos;red&apos;:true,&apos;green&apos;:false}&quot;
</code></pre><p>方法四、</p>
<pre><code>ng-class=&quot;style2&quot;

style2 { background: #dddddd; }
</code></pre><p>tempClass是CSS样式名称</p>
</li>
<li><p>ng-show/ng-hide</p>
<p>控制元素的显示与否,ng-show与ng-hide作用是相反的(只是设置display:none来隐藏元素)</p>
<pre><code>&lt;!-- ng-show,控制元素的显示或隐藏,值为true时显示，为false隐藏--&gt;
&lt;p ng-show=&quot;isShowing&quot;&gt;ng-show值为true时显示&lt;/p&gt;

&lt;!-- ng-hide 值为true时，隐藏当前元素 --&gt;
&lt;p ng-hide=&quot;true&quot;&gt;ng-hide值为true时隐藏&lt;/p&gt;
</code></pre></li>
<li><p>ng-if</p>
<p>控制元素的显示与否:值为false时，元素会从dom移除</p>
<pre><code>&lt;!-- ng-if，也能控制元素的显示或隐藏,为true时显示,为false时【会将当前dom元素移除】 --&gt;
&lt;p ng-if=&quot;true&quot;&gt;这个标签不会被移除&lt;/p&gt;
&lt;h1&gt;ng-if=&quot;false&quot;&lt;/h1&gt;
&lt;p ng-if=&quot;false&quot;&gt;这个标签会被移除&lt;/p&gt;
</code></pre></li>
<li><p>ng-switch</p>
<p>当ng-switch-when 对应的值等于ng-switch对应值时，当前dom元素就显示</p>
<pre><code>&lt;div ng-switch=&quot;name&quot;&gt;
  &lt;div ng-switch-when=&quot;小明&quot;&gt;
    我是小明，我在这里！
  &lt;/div&gt;
  &lt;div ng-switch-when=&quot;小红&quot;&gt;
    我是小红!
  &lt;/div&gt;
&lt;/div&gt;
</code></pre></li>
<li><p>ng-href</p>
<p>在href属性中直接写angular标记，当用户在angular替换的值之前就点击了链接，那么就会链接到错误的地址，通常会返回404错误。</p>
<p>错误的写法：</p>
<pre><code>&lt;a href=&quot;http://www.somelinks.com/{{hash}}&quot;&gt;&lt;/a&gt;
</code></pre><p>正确的写法</p>
<pre><code>&lt;a ng-href=&quot;http://www.somelinks.com/{{hash}}&quot;&gt;&lt;/a&gt;
</code></pre></li>
<li><p>ng-src</p>
<p>在src属性中使用angular标记不会得到正确的结果，在angular未替换的值之前，浏览器会通过字面的意思去获取src资源。这样就会导致错误。ng-src解决了这个问题</p>
<p>有bug的写法：</p>
<pre><code>&lt;img src=&quot;http://www.somelinks.com/{{hash}}&quot; /&gt;
</code></pre><p>正确的写法：</p>
<pre><code>&lt;img ng-src=&quot;http://www.somelinks.com/{{hash}}&quot; /&gt;
</code></pre></li>
<li><p>ng-click</p>
<p>ng-click 指令告诉了 AngularJS HTML 元素被点击后需要执行的操作。</p>
<pre><code>&lt;button ng-click=&quot;count = count + 1&quot; ng-init=&quot;count=0&quot;&gt;OK&lt;/button&gt;
</code></pre><p>同样的指令还有：ngDblclick ngMousedown ngMouseUp ngMouseover ngMouseenter ngMouseleave ngMousemove ngKeydown ngKeyup ngKeypress</p>
</li>
</ol>
<h3 id="angular的自定义指令"><a href="#angular的自定义指令" class="headerlink" title="angular的自定义指令"></a>angular的自定义指令</h3><p>通过AngularJS模块的directive()方法来定义指令。该方法有两个参数。第一个参数是字符串，代表着指令的名字，必须是驼峰命名法，但在使用它时需要以 - 分割。第二个参数是函数，该函数返回一个对象，这个对象定义了指令的所有行为（也可以简单的返回一个函数，该函数相当于只定义了该对象的link属性，只是在构建简单指令的一个语法糖）。在DOM元素调用指令时，会使用$compile服务利用该对象来构造指令的行为。</p>
<pre><code>angular.module(&apos;app&apos;, []).directive(&apos;myDirective&apos;, function() {
    return {
        restrict:String,                
        priority:Number,
        terminal:Boolean,
        template:String or Template Function,
        templateUrl:String or Template Function,
        replace:Boolean or String,
        transclude:Boolean,
        scope:Boolean or Object,
        controller:String or function(scope, element, attrs, transclude, otherInjectables) { ... },
        controllerAs:String,
        require:String,
        link: function(scope, iElement, iAttrs) { ... },
        compile:function(tElement, tAttrs, transclude) {
            return {
                pre: function(scope, iElement, iAttrs, controller) { ... },
                post: function(scope, iElement, iAttrs, controller) { ... }
               }
            return function postLink(...) { ... }
        }
    };
 });
</code></pre><ol>
<li><p>restrict属性</p>
<p>该属性是一个字符串，该字符串的字母代表指令可以使用何种形式被声明。<br>可选值含义用法实例</p>
<ul>
<li>E元素 &lt; my-directive&gt;&lt; /my-directive&gt;</li>
<li>A属性（默认） &lt; div my-directive&gt;&lt; /div&gt;</li>
<li>C类名 &lt; div class=”my-directive”&gt;&lt; /div&gt;</li>
<li>M注释 &lt;–direcctive:my-directive–&gt;</li>
</ul>
<p>例如”EA”代表着可以用元素和属性的方式声明指令，而类名和注释则不行。</p>
</li>
<li><p>priority属性</p>
<p>priority是指令执行优先级。若在单个DOM上有多个指令，则优先级高的先执行；<br>设置指令的优先级算是不常用的</p>
</li>
<li><p>terminal属性</p>
<p>该属性值为布尔型，默认为false。这个属性是用来告诉AngularJS，当该指令值为false时是否停止运行当前元素上比本指令优先级低的指令（同优先级的仍然会运行）。 </p>
<p>一个例子是ngView和ngIf，ngIf的优先级略高于ngView，如果ngIf表达式为false，那么ngView就不会被执行。</p>
</li>
<li><p>template属性</p>
<p>template属性值为字符串或函数。如果是字符串，那么它代表着一段HTML文本，如果是函数，它可以接收两个参数tElement和tAttrs，其中t代表template，该词是相对与instance而言的，也就所是所谓的模板和实例，该函数会返回一个代表模板的字符串。故无论是字符串还是函数，template代表的就是一个HTML模板。 </p>
<p>模板字符串中至少得有一个根DOM元素，即使它只有一个文本节点，另外由于字符串多行必须使用+号或者用\，使得维护起来非常麻烦以及不美观，所以强烈推荐使用templateUrl。</p>
</li>
<li><p>templateUrl属性</p>
<p>templateUrl属性值可以是字符串或函数。如果是字符串，那么它代表了一个外部HTML文件的路径，如果是函数，那么它同样有tElement和tAttrs两个参数，函数返回一个外部HTML文件路径的字符串。</p>
</li>
<li><p>replace属性</p>
<p>replace属性是个布尔值，默认为false。默认情况下，template或templateUrl提供的模板会被当做子元素插入到调用此指令的元素内部。而如果设置该属性为true，那么会替代该元素。</p>
</li>
<li><p>transclude属性</p>
<p>transclude是移动一个标识符的原始字节带到一个新模块的位置。当你开启transclude后，你就可以使用ng-transclude来指明了应该在什么地方放置transcluded内容。</p>
<p>通俗的讲就是讲指令里面嵌套的元素放置到ng-transclude里面。</p>
</li>
<li><p>compile与link属性</p>
<p>compile属性值与link属性值都是一个函数，link函数又返回一个具有pre(一般称为pre-link)和post(一般称为post-link)函数的对象（如果只返回一个函数，那么是post-link函数）。compile属性与link属性是互斥的，如果同时存在会忽略link属性。也就是说，如果有compile函数也有pre和post-函数，那么就不能有link属性，只能将包含pre函数和post函数的对象由compile函数来返回。</p>
<p>link通过代码修改目标DOM元素的实例，添加事件监听，建立数据绑定。compile函数用来对模板自身进行转换，而link函数负责在模型和视图之间进行动态关联；compile函数仅仅在编译阶段运行一次，而对于指令的每个实例，link函数都会执行一次；compile可以返回preLink和postLink函数，而link函数只会返回postLink函数，如果需要修改DOM结构，应该在postLink中来做这件事情，而如果在preLink中做这件事情会导致错误；大多数时候我们只要编写link函数即可。</p>
<p>link的参数有四个：</p>
<p>（1）scope，与指令元素相关联的作用域</p>
<p>（2）element，当前指令对应的 元素</p>
<p>（3）attrs，由当前元素的属性组成的对象</p>
<p>（4）supermanCtrl，若指令中定义有require选项，则会有supermanCtrl参数，代表控制器或者所依赖的指令的控制器。</p>
<pre><code>var myModule = angular.module(&quot;MyModule&quot;, []);
myModule.directive(&quot;hello&quot;, function() {
  return {
  restrict:&quot;AE&quot;,
  link:function(scope,element,attrs,supermanCtrl){
        console.log(element);
        element.bind(&quot;mouseenter&quot;,function(){
        console.log(&quot;鼠标进入...&quot;);
        });
        element.bind(&quot;mouseout&quot;,function(){
        console.log(&quot;鼠标滑出...&quot;);
        });
    }
  }
});
</code></pre><p>下面实例通过link函数实现指令的复用，两个控制器与一个指令之间进行交互。指令可以调用控制器MyCtrl和MyCtrl2中的方法，但是需要注意我们必须使用属性，因为两个控制器的方法不同。</p>
<pre><code>&lt;!doctype html&gt;
&lt;html ng-app=&quot;MyModule&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div ng-controller=&quot;MyCtrl&quot;&gt;
&lt;loader howToLoad=&quot;loadData()&quot;&gt;滑动加载&lt;/loader&gt;
&lt;/div&gt;
&lt;div ng-controller=&quot;MyCtrl2&quot;&gt;
&lt;loader howToLoad=&quot;loadData2()&quot;&gt;滑动加载&lt;/loader&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;script src=&quot;framework/angular-1.3.0.14/angular.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
var myModule = angular.module(&quot;MyModule&quot;, []);
myModule.controller(&apos;MyCtrl&apos;, [&apos;$scope&apos;, function($scope){
  $scope.loadData=function(){
console.log(&quot;加载数据中111...&quot;);
  }
}]);
myModule.controller(&apos;MyCtrl2&apos;, [&apos;$scope&apos;, function($scope){
  $scope.loadData2=function(){
    console.log(&quot;加载数据中222...&quot;);
  }
}]);
myModule.directive(&quot;loader&quot;, function() {
return {
restrict:&quot;AE&quot;,
link:function(scope,element,attrs){
element.bind(&apos;mouseenter&apos;, function(event) {
        //注意这里的坑，howToLoad会被转换成小写的howtoload
        scope.$apply(attrs.howtoload);
        });
        }
    }
});
&lt;/script&gt;
&lt;/html&gt;
</code></pre><p>另外我们可以在require的参数值加上下面的某个前缀，这会改变查找控制器的行为：</p>
<p>（1）没有前缀，指令会在自身提供的控制器中进行查找，如果找不到任何控制器，则会抛出一个error</p>
<p>（2）？如果在当前的指令没有找到所需的控制器，则会将null传给link连接函数的第四个参数</p>
<p>（3）^如果在当前的指令没有找到所需的控制器，则会查找父元素的控制器</p>
<p>（4）?^组合</p>
</li>
<li><p>controller属性</p>
<p>为自定义指令添加一个控制器，使多个指令之间可以通信。</p>
<p>controller的值可以为字符串和匿名函数</p>
<p>1）字符串</p>
<p>若是为字符串，则将字符串当做是控制器的名字，来查找注册在应用中的控制器的构造函数</p>
<pre><code>angular.module(&apos;myApp&apos;).controller(&apos;SomeController&apos;, function($scope, $element, $attrs, $transclude) {
    // 控制器逻辑放在这里
});
angular.module(&apos;myApp&apos;, []) .directive(&apos;myDirective&apos;, function() {
    restrict: &apos;A&apos;,
    controller: &apos;SomeController&apos;
})
</code></pre><p>2）匿名函数</p>
<p>也可以直接在指令内部的定义为匿名函数，同样我们可以再这里注入任何服务（$log,$timeout等等）</p>
<pre><code>angular.module(&apos;myApp&apos;,[]) .directive(&apos;myDirective&apos;, function() {
    restrict: &apos;A&apos;,
    controller: function($scope, $element, $attrs, $transclude) {
    // 控制器逻辑放在这里
    }
});
</code></pre><p>（a）$scope，与指令元素相关联的作用域</p>
<p>（b）$element，当前指令对应的元素</p>
<p>（c）$attrs，由当前元素的属性组成的对象</p>
<p>（d）$transclude，嵌入链接函数，实际被执行用来克隆元素和操作DOM的函数</p>
<p>注意： 除非是用来定义一些可复用的行为，一般不推荐在这使用。</p>
<p>指令的控制器和link函数可以进行互换。区别在于，控制器主要是用来提供可在指令间复用的行为但link链接函数只能在当前内部指令中定义行为，且无法再指令间复用。</p>
</li>
<li><p>require属性</p>
<p>require当前标识符需要另一个标识符提供正确的函数功能。require的值可以是字符串或者数组。字符串代表另一个指令的名字，它将会作为link函数的第四个参数。controller的用法分为两种情形，一种是require自定义的controller，由于自定义controller中的属性方法都由自己编写，使用起来比较简单；另一种方法则是require AngularJS内建的指令，其中大部分时间需要require的都是ngModel这个指令。</p>
<p>下面是实例程序：假设现在我们要编写三个指令，三个指令中的link链接函数中存在有很多重合的方法，这时候我们就可以将这些重复的方法写在一个指令的controller中。然后在这三个指令中，require这个拥有controller字段的的指令，最后通过link链接函数的第四个参数就可以引用这些重合的方法了。</p>
<pre><code>&lt;!doctype html&gt;
&lt;html ng-app=&quot;MyModule&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap-3.0.0/css/bootstrap.css&quot;&gt;
    &lt;script src=&quot;js/angular.min.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;row&quot;&gt;
&lt;div class=&quot;col-md-3&quot;&gt;
&lt;superman strength&gt;动感超人---力量&lt;/superman&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;br&gt;
&lt;div class=&quot;row&quot;&gt;
&lt;div class=&quot;col-md-3&quot;&gt;
&lt;superman strength speed&gt;动感超人2---力量+敏捷&lt;/superman&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;br&gt;
&lt;div class=&quot;row&quot;&gt;
&lt;div class=&quot;col-md-3&quot;&gt;
&lt;superman strength speed light&gt;动感超人3---力量+敏捷+发光&lt;/superman&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
var myModule = angular.module(&quot;MyModule&quot;, []);
myModule.directive(&quot;superman&quot;, function() {
    return {
        scope: {},
        restrict: &apos;AE&apos;,
        controller: function($scope) {
            $scope.abilities = [];
            this.addStrength = function() {
                $scope.abilities.push(&quot;strength&quot;);
            };
            this.addSpeed = function() {
                $scope.abilities.push(&quot;speed&quot;);
            };
            this.addLight = function() {
                $scope.abilities.push(&quot;light&quot;);
            };
        },
        link: function(scope, element, attrs) {
            element.addClass(&apos;btn btn-primary&apos;);
            element.bind(&quot;mouseenter&quot;, function() {
                console.log(scope.abilities);
            });
        }
    }
});
myModule.directive(&quot;strength&quot;, function() {
    return {
        require: &apos;^superman&apos;,
        link: function(scope, element, attrs, supermanCtrl) {
            supermanCtrl.addStrength();
        }
    }
});
myModule.directive(&quot;speed&quot;, function() {
    return {
        require: &apos;^superman&apos;,
        link: function(scope, element, attrs, supermanCtrl) {
            supermanCtrl.addSpeed();
        }
    }
});
myModule.directive(&quot;light&quot;, function() {
    return {
        require: &apos;^superman&apos;,
        link: function(scope, element, attrs, supermanCtrl) {
            supermanCtrl.addLight();
        }
    }
});
&lt;/script&gt;
&lt;/html&gt;
</code></pre></li>
<li><p>scope属性</p>
<p>scope的值分别为：false，true，{}</p>
<p>1） false（默认值）：直接使用父scope。比较“危险”。</p>
<p>可以理解成指令内部并没有一个新的scope，它和指令以外的代码共享同一个scope。</p>
<p>（1）定义指令</p>
<pre><code>app.directive(&apos;myDirective&apos;, function() {
    return {
        restrict: &apos;E&apos;,
        replace: true,
        templateUrl: &apos;../templates/my_template_01.html&apos;,
        scope: false,   // 默认值
        controller: null
    }
});
</code></pre><p>（2）指令模板</p>
<pre><code>&lt;div&gt;
    &lt;!--这里ng-model绑定的input，就是父scope的变量input--&gt;
    &lt;p&gt;自定义指令scope：&lt;input type=&quot;text&quot; ng-model=&quot;input&quot;&gt;&lt;/p&gt;

    &lt;p&gt;结果：{{input}}&lt;/p&gt;
&lt;/div&gt;
</code></pre><p>（3）指令的使用</p>
<pre><code>&lt;body ng-app=&quot;watchDemo&quot; ng-controller=&quot;controller01&quot;&gt;
    &lt;p&gt;父scope：&lt;input type=&quot;text&quot; ng-model=&quot;input&quot;&gt;&lt;/p&gt;

    &lt;!--自定义指令--&gt;
    &lt;my-directive&gt;&lt;/my-directive&gt;
&lt;/body&gt;
</code></pre><p>因为是同一个scope，所以无论是改变my-directive里面还是外面的输入框中的文字，都会改变这个scope中的“input”的值。（继承不隔离）</p>
<p>2) true ：继承父scope</p>
<p>（1）定义指令</p>
<pre><code>app.directive(&apos;myDirective&apos;, function() {
    return {
        restrict: &apos;E&apos;,
        replace: true,
        templateUrl: &apos;../templates/my_template_01.html&apos;,
        scope: true,   // 只是改动了这里
        controller: null
    }
});
</code></pre><p>（2）指令模板</p>
<pre><code>&lt;div&gt;
    &lt;!--这里ng-model绑定的input，就是父scope的变量input--&gt;
    &lt;p&gt;自定义指令scope：&lt;input type=&quot;text&quot; ng-model=&quot;input&quot;&gt;&lt;/p&gt;

    &lt;p&gt;结果：{{input}}&lt;/p&gt;
&lt;/div&gt;
</code></pre><p>（3）指令的使用</p>
<pre><code>&lt;body ng-app=&quot;watchDemo&quot; ng-controller=&quot;controller01&quot;&gt;
    &lt;p&gt;父scope：&lt;input type=&quot;text&quot; ng-model=&quot;input&quot;&gt;&lt;/p&gt;

    &lt;!--自定义指令--&gt;
    &lt;my-directive&gt;&lt;/my-directive&gt;
&lt;/body&gt;
</code></pre><p>一开始是绑定在父scope中，但当修改位于自定义指令中的输入框时，子scope就被创建并继承父scope了。之后，修改父scope并不能影响input的值，而修改子scope就可以改变input的值了。（继承隔离）</p>
<p>3）{ }：创建一个新的“隔离”scope，但仍可与父scope通信</p>
<p>隔离的scope，通常用于创建可复用的指令，也就是它不用管父scope中的model。然而虽然说是“隔离”，但通常我们还是需要让这个子scope跟父scope中的变量进行绑定。绑定的策略有3种：</p>
<pre><code>&lt;div ng-app=&quot;MyApp&quot;&gt;
    &lt;div class=&quot;container&quot; ng-controller=&quot;MyController&quot;&gt;
        &lt;div class=&quot;my-info&quot;&gt;我的名字是：&lt;span ng-bind=&quot;name&quot;&gt;&lt;/span&gt;
            &lt;br/&gt;我的年龄是：&lt;span ng-bind=&quot;age&quot;&gt;&lt;/span&gt;
            &lt;br /&gt;
        &lt;/div&gt;
        &lt;div class=&quot;my-directive&quot; my-directive my-name=&quot;{{name}}&quot; age=&quot;age&quot;  change-my-age=&quot;changeAge()&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;

angular.module(&quot;MyApp&quot;, [])
    .controller(&quot;MyController&quot;, function ($scope) {
    $scope.name = &quot;dreamapple&quot;;
    $scope.age = 20;
    $scope.changeAge = function(){
        $scope.age = 0;
    }
})
    .directive(&quot;myDirective&quot;, function () {
    return {
        restrict: &quot;AE&quot;,
        scope: {
            name: &apos;@myName&apos;,
            age: &apos;=&apos;,
            changeAge: &apos;&amp;changeMyAge&apos;
        },
        replace: true,
        template: &quot;&lt;div class=&apos;my-directive&apos;&gt;&quot; +
            &quot;&lt;h3&gt;下面部分是我们创建的指令生成的&lt;/h3&gt;&quot; +
            &quot;我的名字是：&lt;span ng-bind=&apos;name&apos;&gt;&lt;/span&gt;&lt;br/&gt;&quot; +
            &quot;我的年龄是：&lt;span ng-bind=&apos;age&apos;&gt;&lt;/span&gt;&lt;br/&gt;&quot; +
            &quot;在这里修改名字：&lt;input type=&apos;text&apos; ng-model=&apos;name&apos;&gt;&lt;br/&gt;&quot; +
            &quot;&lt;button ng-click=&apos;changeAge()&apos;&gt;修改年龄&lt;/button&gt;&quot; +
            &quot; &lt;/div&gt;&quot;
    }
});
</code></pre><p>（1）@：单向绑定</p>
<p>使用方法：在元素中使用属性，好比这样&lt; div my-directive my-name=”{ {name} }”&gt;&lt; /div&gt;，注意，属性的名字要用-将两个单词连接，因为是数据的单项绑定所以要通过使用{ { } }来绑定数据。</p>
<p>（2）=：双向绑定</p>
<p>使用方法：在元素中使用属性，好比这样&lt; div my-directive age=”age”&gt;&lt; /div&gt;,注意，数据的双向绑定要通过=前缀标识符实现，所以不可以使用{ { } }。</p>
<p>（3）&amp;：绑定函数</p>
<p>使用方法：在元素中使用属性，好比这样&lt; div my-directive change-my-age=”changeAge()”&gt;&lt; /div&gt;，注意，属性的名字要用-将多个个单词连接。</p>
<p>注意：在新创建指令的作用域对象中，使用属性的名字进行绑定时，要使用驼峰命名标准，比如下面的代码。</p>
<pre><code>scope: {
    // `myName` 就是原来元素中的`my-name`属性
    name: &apos;@myName&apos;, 
    age: &apos;=&apos;,
    // `changeMyAge`就是原来元素中的`change-my-age`属性
    changeAge: &apos;&amp;changeMyAge&apos; 
}
</code></pre></li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/angular/" rel="tag"># angular</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/07/10/Error-git-github-com-Permission-denied-publickey/" rel="next" title="解决方案 git@github.com 出现 Permission denied (publickey)">
                <i class="fa fa-chevron-left"></i> 解决方案 git@github.com 出现 Permission denied (publickey)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Aaron Wang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#angular的指令"><span class="nav-number">1.</span> <span class="nav-text">angular的指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#angular的内置指令"><span class="nav-number">1.1.</span> <span class="nav-text">angular的内置指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#angular的自定义指令"><span class="nav-number">1.2.</span> <span class="nav-text">angular的自定义指令</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Aaron Wang</span>

  
</div>
<div class="powered-by">
  <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
    本站访客数:<span id="busuanzi_value_site_uv"></span>
  </span>
</div>
<!-- 
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>
 -->

<!-- 
  <span class="post-meta-divider">|</span>
 -->

<!-- 
  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>
 -->



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<script src="/js/src/love.js" type="text/javascript"></script>